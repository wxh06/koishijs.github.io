(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{371:function(t,a,s){"use strict";s.r(a);var e=s(25),o=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"上下文"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上下文"}},[t._v("#")]),t._v(" 上下文 (Context)")]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("这里是"),s("strong",[t._v("正在施工")]),t._v("的 koishi v2 的文档。要查看 v1 版本的文档，请前往"),s("a",{attrs:{href:"https://koishijs.github.io/v1/",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("这里")]),s("OutboundLink")],1),t._v("。")])]),t._v(" "),s("p",[s("strong",[t._v("上下文 (Context)")]),t._v(" 是 Koishi 的重要概念。你的每一个插件，中间件，监听器和指令都被绑定在上下文上。")]),t._v(" "),s("h2",{attrs:{id:"ctx-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-database"}},[t._v("#")]),t._v(" ctx.database")]),t._v(" "),s("p",[t._v("当前应用的 "),s("RouterLink",{attrs:{to:"/api/database.html#数据库对象"}},[t._v("Database")]),t._v(" 对象。")],1),t._v(" "),s("h2",{attrs:{id:"ctx-bots"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-bots"}},[t._v("#")]),t._v(" ctx.bots")]),t._v(" "),s("p",[t._v("当前应用所绑定的全部 "),s("RouterLink",{attrs:{to:"/api/bot.html"}},[t._v("Bot")]),t._v(" 实例。你可以将其当做一个 Bot 数组，也可以直接使用 QQ 号作为其索引：")],1),t._v(" "),s("panel-view",{staticClass:"code",attrs:{title:""}},[s("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[s("code",[s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("ctx.bots[")]),s("span",{staticStyle:{color:"#AE81FF"}},[t._v("0")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("].selfId                    ")]),s("span",{staticStyle:{color:"#75715E"}},[t._v("// 123456789")]),t._v("\n"),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("ctx.bots[")]),s("span",{staticStyle:{color:"#AE81FF"}},[t._v("123456789")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("] ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("===")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ctx.bots[")]),s("span",{staticStyle:{color:"#AE81FF"}},[t._v("0")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("]   ")]),s("span",{staticStyle:{color:"#75715E"}},[t._v("// true")]),t._v("\n"),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("ctx.bots.length                       ")]),s("span",{staticStyle:{color:"#75715E"}},[t._v("// 1")])])])]),s("h2",{attrs:{id:"过滤器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#过滤器"}},[t._v("#")]),t._v(" 过滤器")]),t._v(" "),s("h3",{attrs:{id:"ctx-user"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-user"}},[t._v("#")]),t._v(" ctx.user(...ids)")]),t._v(" "),s("p",[t._v("在已有上下文的基础上加上其他上下文。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("context:")]),t._v(" "),s("code",[t._v("Context")]),t._v(" 要加上的上下文")]),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("Context")]),t._v(" 新的上下文")])]),t._v(" "),s("h3",{attrs:{id:"ctx-private"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-private"}},[t._v("#")]),t._v(" ctx.private(...ids)")]),t._v(" "),s("p",[t._v("在已有上下文的基础上除去其他上下文。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("context:")]),t._v(" "),s("code",[t._v("Context")]),t._v(" 要除去的上下文")]),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("Context")]),t._v(" 新的上下文")])]),t._v(" "),s("h3",{attrs:{id:"ctx-group"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-group"}},[t._v("#")]),t._v(" ctx.group(...ids)")]),t._v(" "),s("p",[t._v("给出当前上下文和其他上下文的交集")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("context:")]),t._v(" "),s("code",[t._v("Context")]),t._v(" 要求交集的上下文")]),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("Context")]),t._v(" 新的上下文")])]),t._v(" "),s("h3",{attrs:{id:"ctx-match"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-match"}},[t._v("#")]),t._v(" ctx.match(meta)")]),t._v(" "),s("p",[t._v("测试上下文能否匹配元信息对象。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("meta:")]),t._v(" "),s("code",[t._v("Meta")]),t._v(" 元信息对象")]),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("boolean")]),t._v(" 匹配结果")])]),t._v(" "),s("h3",{attrs:{id:"ctx-contain"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-contain"}},[t._v("#")]),t._v(" ctx.contain(context)")]),t._v(" "),s("p",[t._v("判断当前上下文是否完全包含了另一个上下文。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("context:")]),t._v(" "),s("code",[t._v("Context")]),t._v(" 要比较的上下文")]),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("boolean")]),t._v(" 比较结果")])]),t._v(" "),s("h2",{attrs:{id:"钩子与中间件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#钩子与中间件"}},[t._v("#")]),t._v(" 钩子与中间件")]),t._v(" "),s("h3",{attrs:{id:"ctx-emit"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-emit"}},[t._v("#")]),t._v(" ctx.emit(meta?, event, ...param)")]),t._v(" "),s("h3",{attrs:{id:"ctx-parallel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-parallel"}},[t._v("#")]),t._v(" ctx.parallel(meta?, event, ...param)")]),t._v(" "),s("h3",{attrs:{id:"ctx-bail"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-bail"}},[t._v("#")]),t._v(" ctx.bail(meta?, event, ...param)")]),t._v(" "),s("h3",{attrs:{id:"ctx-serial"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-serial"}},[t._v("#")]),t._v(" ctx.serial(meta?, event, ...param)")]),t._v(" "),s("h3",{attrs:{id:"ctx-on"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-on"}},[t._v("#")]),t._v(" ctx.on(event, listener)")]),t._v(" "),s("h3",{attrs:{id:"ctx-once"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-once"}},[t._v("#")]),t._v(" ctx.once(event, listener)")]),t._v(" "),s("h3",{attrs:{id:"ctx-before"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-before"}},[t._v("#")]),t._v(" ctx.before(event, listener)")]),t._v(" "),s("h3",{attrs:{id:"ctx-off"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-off"}},[t._v("#")]),t._v(" ctx.off(event, listener)")]),t._v(" "),s("h3",{attrs:{id:"ctx-middleware"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-middleware"}},[t._v("#")]),t._v(" ctx.middleware(middleware)")]),t._v(" "),s("p",[t._v("当前上下文中注册一个中间件。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("middleware:")]),t._v(" "),s("RouterLink",{attrs:{to:"/guide/message.html#中间件"}},[s("code",[t._v("Middleware")])]),t._v(" 要注册的中间件")],1),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("this")])])]),t._v(" "),s("h3",{attrs:{id:"ctx-prependmiddleware"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-prependmiddleware"}},[t._v("#")]),t._v(" ctx.prependMiddleware(middleware)")]),t._v(" "),s("p",[t._v("当前上下文中注册一个前置中间件。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("middleware:")]),t._v(" "),s("RouterLink",{attrs:{to:"/guide/message.html#中间件"}},[s("code",[t._v("Middleware")])]),t._v(" 要注册的前置中间件")],1),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("this")])])]),t._v(" "),s("h3",{attrs:{id:"ctx-removemiddleware"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-removemiddleware"}},[t._v("#")]),t._v(" ctx.removeMiddleware(middleware)")]),t._v(" "),s("p",[t._v("移除当前上下文中一个已注册的中间件。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("middleware:")]),t._v(" "),s("RouterLink",{attrs:{to:"/guide/message.html#中间件"}},[s("code",[t._v("Middleware")])]),t._v(" 要移除的中间件")],1),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("boolean")]),t._v(" 是否存在该中间件")])]),t._v(" "),s("h2",{attrs:{id:"指令与插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指令与插件"}},[t._v("#")]),t._v(" 指令与插件")]),t._v(" "),s("h3",{attrs:{id:"ctx-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-plugin"}},[t._v("#")]),t._v(" ctx.plugin(plugin, options?)")]),t._v(" "),s("p",[t._v("当前上下文中安装一个插件。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("plugin:")]),t._v(" "),s("code",[t._v("Plugin<T, U>")]),t._v(" 要安装的插件")]),t._v(" "),s("li",[s("strong",[t._v("options:")]),t._v(" "),s("code",[t._v("U")]),t._v(" 要传入插件的参数，如果为 "),s("code",[t._v("false")]),t._v(" 则插件不会被安装")]),t._v(" "),s("li",[t._v("返回值: "),s("code",[t._v("this")])])]),t._v(" "),s("panel-view",{staticClass:"code",attrs:{title:""}},[s("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[s("code",[s("span",{staticStyle:{color:"#66D9EF"}},[t._v("type")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("PluginFunction")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" <")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("T")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("extends")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("Context")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("U")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("> ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" (")]),s("span",{staticStyle:{color:"#FD971F"}},[t._v("ctx")]),s("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("T")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),s("span",{staticStyle:{color:"#FD971F"}},[t._v("options")]),s("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("U")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),s("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#66D9EF"}},[t._v("void")]),t._v("\n"),s("span",{staticStyle:{color:"#66D9EF"}},[t._v("type")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("PluginObject")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" <")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("T")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("extends")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("Context")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("U")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("> ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" { apply")]),s("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("PluginFunction")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("<")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("T")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("U")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("> }")]),t._v("\n"),s("span",{staticStyle:{color:"#66D9EF"}},[t._v("type")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("Plugin")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" <")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("T")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("extends")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("Context")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("U")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("> ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("PluginFunction")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("<")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("T")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("U")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("> ")]),s("span",{staticStyle:{color:"#F92672"}},[t._v("|")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("PluginObject")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v("<")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("T")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),s("span",{staticStyle:{color:"#A6E22E"}},[t._v("U")]),s("span",{staticStyle:{color:"#F8F8F2"}},[t._v(">")])])])]),s("h3",{attrs:{id:"ctx-command"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-command"}},[t._v("#")]),t._v(" ctx.command(rawName, description?, config?)")]),t._v(" "),s("p",[t._v("在当前上下文中注册或修改一个指令。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("rawName:")]),t._v(" "),s("code",[t._v("string")]),t._v(" 指令名以及可能的参数")]),t._v(" "),s("li",[t._v("description?: "),s("code",[t._v("string")]),t._v(" 指令的描述")]),t._v(" "),s("li",[t._v("config?: "),s("RouterLink",{attrs:{to:"/guide/command-system.html#commandconfig-对象"}},[s("code",[t._v("CommandConfig")])]),t._v(" 指令的配置")],1),t._v(" "),s("li",[t._v("返回值："),s("RouterLink",{attrs:{to:"/api/command.html"}},[s("code",[t._v("Command")])]),t._v(" 注册或修改的指令")],1)]),t._v(" "),s("h3",{attrs:{id:"ctx-logger"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-logger"}},[t._v("#")]),t._v(" ctx.logger(scope?) "),s("Badge",{attrs:{text:"1.3.0+"}})],1),t._v(" "),s("p",[t._v("根据 namespace 生成一个 "),s("RouterLink",{attrs:{to:"/guide/logger.html#使用-logger"}},[t._v("Logger 对象")]),t._v("。")],1),t._v(" "),s("ul",[s("li",[s("strong",[t._v("scope:")]),t._v(" "),s("code",[t._v("string")]),t._v(" 要指定的类型，默认为 "),s("code",[t._v("''")])]),t._v(" "),s("li",[t._v("返回值: "),s("RouterLink",{attrs:{to:"/guide/logger.html#使用-logger"}},[s("code",[t._v("Logger")])])],1)]),t._v(" "),s("h3",{attrs:{id:"ctx-dispose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-dispose"}},[t._v("#")]),t._v(" ctx.dispose() "),s("Badge",{attrs:{text:"beta",type:"warn"}})],1),t._v(" "),s("p",[t._v("移除当前插件中所注册的钩子、中间件和指令。")]),t._v(" "),s("ul",[s("li",[t._v("返回值: "),s("code",[t._v("void")])])])],1)}),[],!1,null,null,null);a.default=o.exports}}]);